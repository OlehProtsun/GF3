<UserControl x:Class="WPFApp.View.Container.ContainerProfileView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:design="clr-namespace:WPFApp.DesignTime"
             d:DataContext="{d:DesignInstance Type=design:ContainerProfileViewDesignVm, IsDesignTimeCreatable=True}"
             mc:Ignorable="d"
             d:DesignHeight="2000" d:DesignWidth="852"
             Background="{StaticResource PageBackgroundBrush}">

    <UserControl.Resources>

        <!-- Проста іконка "дві панелі" (можеш замінити на свою Geometry) -->
        <GeometryGroup x:Key="MultiOpenIconOn">
            <PathGeometry Figures="M1105 4675 c-305 -68 -537 -278 -638 -575 l-32 -95 -3 -1412 c-3 -1546 -5 -1467 57 -1628 41 -107 100 -195 190 -286 91 -90 179 -149 286 -190 161 -62 82 -60 1628 -57 l1412 3 95 33 c141 49 231 104 330 202 100 99 158 183 201 295 58 150 59 155 59 823 0 584 -1 615 -19 650 -83 162 -299 162 -382 0 -18 -35 -19 -66 -19 -600 0 -314 -4 -589 -10 -622 -30 -183 -173 -326 -356 -356 -79 -13 -2609 -13 -2688 0 -183 30 -326 173 -356 356 -13 79 -13 2609 0 2688 30 183 173 326 356 356 33 6 308 10 619 10 524 0 563 2 600 19 164 76 166 298 3 382 -35 18 -66 19 -655 18 -479 0 -631 -4 -678 -14z"/>
            <PathGeometry Figures="M3099 4667 c-24 -13 -57 -43 -74 -66 -27 -39 -30 -50 -30 -120 0 -68 3 -82 27 -117 15 -21 44 -50 65 -64 l37 -25 420 -3 420 -3 -796 -797 c-644 -645 -798 -804 -808 -836 -18 -57 -9 -147 21 -190 54 -81 160 -116 255 -86 32 10 192 165 836 808 l797 796 3 -420 3 -420 25 -37 c14 -21 43 -50 64 -65 35 -24 49 -27 116 -27 67 0 81 3 116 27 21 15 50 44 64 65 l25 37 0 716 0 717 -27 39 c-15 21 -44 50 -65 64 l-37 25 -706 3 -706 2 -45 -23z"/>
        </GeometryGroup>

        <GeometryGroup x:Key="MultiOpenIconOpen">
            <PathGeometry Figures="M1607 4674 c-492 -89 -878 -488 -953 -984 -10 -70 -14 -196 -14 -473 0 -411 1 -420 58 -480 61 -64 32 -61 662 -68 545 -5 579 -7 657 -27 312 -82 543 -312 625 -625 21 -78 22 -107 25 -651 5 -636 2 -607 77 -674 61 -53 73 -54 546 -49 392 4 444 6 530 25 245 53 423 145 566 294 157 162 250 361 289 618 23 146 22 2008 0 2136 -52 297 -215 562 -458 745 -140 105 -353 194 -527 219 -37 6 -477 9 -1035 9 -791 -1 -984 -3 -1048 -15z m2306 -688 c20 -10 47 -33 60 -50 22 -31 22 -33 25 -512 l3 -480 -23 -34 c-39 -56 -72 -75 -136 -75 -70 0 -115 28 -143 89 -16 36 -19 69 -19 286 l0 245 -412 -412 c-353 -352 -419 -413 -453 -422 -118 -31 -225 76 -194 194 9 34 74 103 423 455 l411 415 -265 5 c-234 4 -269 7 -293 23 -82 53 -91 185 -19 250 49 45 72 47 547 44 417 -2 453 -3 488 -21z"/>
            <PathGeometry Figures="M950 2339 c-278 -30 -431 -152 -496 -394 -17 -64 -19 -112 -19 -560 0 -479 0 -492 23 -568 29 -102 61 -163 114 -220 57 -62 140 -110 241 -138 81 -24 87 -24 572 -24 546 0 549 0 692 70 160 79 239 220 263 475 13 137 13 685 0 823 -29 306 -155 462 -421 522 -61 14 -144 18 -479 20 -223 2 -443 -1 -490 -6z"/>
        </GeometryGroup>

        <GeometryGroup x:Key="MultiOpenIconOff">
            <PathGeometry Figures="M1296 4675 c-436 -88 -768 -422 -851 -858 -23 -119 -23 -2395 0 -2514 83 -438 420 -775 858 -858 119 -23 2395 -23 2514 0 438 83 775 420 858 858 22 118 22 861 0 915 -67 160 -299 170 -383 17 -15 -26 -18 -85 -23 -440 -7 -453 -7 -457 -76 -595 -54 -110 -170 -224 -284 -278 -149 -71 -71 -67 -1349 -67 -937 0 -1165 3 -1210 14 -181 44 -352 180 -428 341 -71 150 -67 72 -67 1350 0 1278 -4 1200 67 1350 54 114 168 229 278 284 146 72 117 69 811 75 l626 6 36 25 c21 14 50 43 65 64 24 35 27 49 27 116 0 67 -3 81 -27 116 -15 21 -44 50 -65 64 l-37 25 -635 2 c-505 1 -650 -1 -705 -12z"/>
            <PathGeometry Figures="M3340 4467 c-48 -15 -113 -83 -128 -133 -8 -27 -12 -115 -12 -258 l0 -216 -148 0 c-494 0 -890 -131 -1159 -384 -175 -164 -311 -414 -374 -686 -26 -111 -38 -406 -19 -487 25 -114 146 -191 254 -162 73 19 101 45 167 151 184 301 487 456 969 498 132 11 234 13 279 4 l31 -6 0 -242 c0 -240 0 -242 26 -294 44 -89 133 -132 234 -111 l55 11 569 566 c385 385 574 580 587 607 10 22 19 62 19 90 0 105 13 92 -592 577 -304 243 -573 453 -597 465 -48 25 -103 28 -161 10z"/>
        </GeometryGroup>

        <Style x:Key="MultiOpenPrettyButtonStyle"
               TargetType="Button"
               BasedOn="{StaticResource RoundedButtonStyle}">

            <Setter Property="Height" Value="37"/>
            <Setter Property="Padding" Value="12,0"/>
            <Setter Property="Background" Value="{StaticResource BadgeBackgroundBrush}"/>
            <Setter Property="Foreground" Value="{StaticResource MutedTextBrush}"/>

            <Setter Property="ContentTemplate">
                <Setter.Value>
                    <DataTemplate>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="16"/>
                                <ColumnDefinition Width="8"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="8"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <Viewbox Width="14" Height="14" VerticalAlignment="Center">
                                <Path x:Name="Icon"
                                      Data="{StaticResource MultiOpenIconOff}"
                                      Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"
                                      RenderTransformOrigin="0.5,0.5"
                                      Stretch="Uniform">
                                    <Path.RenderTransform>
                                        <ScaleTransform ScaleX="1" ScaleY="-1" />
                                    </Path.RenderTransform>
                                </Path>
                            </Viewbox>

                            <TextBlock Grid.Column="2"
                                       Text="MultiOpen"
                                       VerticalAlignment="Center"
                                       FontSize="12"
                                       Foreground="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"/>

                            <Border x:Name="Badge"
                                    Grid.Column="4"
                                    VerticalAlignment="Center"
                                    CornerRadius="6"
                                    Padding="7,2"
                                    Background="#22000000">
                                <TextBlock x:Name="BadgeText"
                                           Text="OFF"
                                           FontSize="10"
                                           FontWeight="SemiBold"
                                           Foreground="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"/>
                            </Border>
                        </Grid>

                        <DataTemplate.Triggers>
                            <DataTrigger Binding="{Binding DataContext.IsMultiOpenEnabled, RelativeSource={RelativeSource AncestorType=Button}}"
                                         Value="True">
                                <Setter TargetName="Icon" Property="Path.Data" Value="{StaticResource MultiOpenIconOn}"/>
                                <Setter TargetName="BadgeText" Property="Text" Value="ON"/>
                                <Setter TargetName="Badge" Property="Background" Value="#22FFFFFF"/>
                            </DataTrigger>
                        </DataTemplate.Triggers>
                    </DataTemplate>
                </Setter.Value>
            </Setter>

            <Style.Triggers>
                <DataTrigger Binding="{Binding DataContext.IsMultiOpenEnabled, RelativeSource={RelativeSource Self}}"
                             Value="True">
                    <Setter Property="Background" Value="{StaticResource PrimaryBrush}"/>
                    <Setter Property="Foreground" Value="White"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <BooleanToVisibilityConverter x:Key="BoolToVisibility" />

        <Style x:Key="RoundCheckBoxStyle" TargetType="CheckBox">
            <Setter Property="Focusable" Value="False" />
            <Setter Property="Width" Value="20"/>
            <Setter Property="Height" Value="20"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="CheckBox">
                        <Grid Width="{TemplateBinding Width}" Height="{TemplateBinding Height}">
                            <Border x:Name="Box"
                                    CornerRadius="4"
                                    BorderBrush="{StaticResource MutedTextBrush}"
                                    BorderThickness="2"
                                    Background="Transparent"/>

                            <Path x:Name="Tick"
                                  Data="M 3 8 L 7 12 L 13 4"
                                  Stroke="White"
                                  StrokeThickness="2"
                                  StrokeStartLineCap="Round"
                                  StrokeEndLineCap="Round"
                                  Visibility="Collapsed" />
                        </Grid>

                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="Box" Property="Background" Value="{StaticResource PrimaryBrush}" />
                                <Setter TargetName="Box" Property="BorderBrush" Value="{StaticResource PrimaryBrush}" />
                                <Setter TargetName="Tick" Property="Visibility" Value="Visible" />
                            </Trigger>

                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Box" Property="Opacity" Value="0.85" />
                            </Trigger>

                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="Box" Property="Opacity" Value="0.55" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ScheduleCardGridStyle"
               TargetType="DataGrid"
               BasedOn="{StaticResource AvailabilityListCardGridBaseStyle}">

            <Setter Property="RowStyle">
                <Setter.Value>
                    <Style TargetType="DataGridRow">
                        <Setter Property="Height" Value="44" />
                        <Setter Property="Margin" Value="0,8,0,12" />
                        <Setter Property="Background" Value="{StaticResource SurfaceBrush}" />
                        <Setter Property="SnapsToDevicePixels" Value="True" />
                        <Setter Property="BorderThickness" Value="0" />
                        <EventSetter Event="MouseDoubleClick" Handler="DataGridSchedules_MouseDoubleClick"/>
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="DataGridRow">
                                    <Border Background="Transparent"
                                            Margin="6,0,6,0"
                                            PreviewMouseLeftButtonDown="RowHitArea_PreviewMouseLeftButtonDown"
                                            MouseLeftButtonDown="RowHitArea_MouseLeftButtonDown">
                                        <Border x:Name="RowCard"
                                                Background="{TemplateBinding Background}"
                                                CornerRadius="{StaticResource Cr12}"
                                                Padding="18,0,12,0"
                                                SnapsToDevicePixels="True">

                                            <Border.Effect>
                                                <DropShadowEffect BlurRadius="16"
                                                                  ShadowDepth="0"
                                                                  Opacity="0.18" />
                                            </Border.Effect>

                                            <DataGridCellsPresenter />
                                        </Border>
                                    </Border>

                                    <ControlTemplate.Triggers>

                                        <DataTrigger Binding="{Binding IsChecked}" Value="True">
                                            <Setter TargetName="RowCard" Property="Background" Value="{StaticResource PrimaryBrush}" />
                                            <Setter Property="Foreground" Value="White" />
                                        </DataTrigger>

                                        <MultiDataTrigger>
                                            <MultiDataTrigger.Conditions>
                                                <Condition Binding="{Binding IsSelected, RelativeSource={RelativeSource Self}}" Value="True" />
                                                <Condition Binding="{Binding DataContext.IsMultiOpenEnabled, RelativeSource={RelativeSource AncestorType=DataGrid}}" Value="False" />
                                            </MultiDataTrigger.Conditions>
                                            <Setter TargetName="RowCard" Property="Background" Value="{StaticResource PrimaryBrush}" />
                                            <Setter Property="Foreground" Value="White" />
                                        </MultiDataTrigger>

                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="RowCard" Property="Opacity" Value="0.97" />
                                        </Trigger>

                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ContainerStatsGridStyle"
               TargetType="DataGrid"
               BasedOn="{StaticResource AvailabilityBaseGridStyle}">
            <Setter Property="HeadersVisibility" Value="Column" />
            <Setter Property="RowHeaderWidth" Value="0" />
            <Setter Property="SelectionUnit" Value="FullRow" />
            <Setter Property="SelectionMode" Value="Single" />
            <Setter Property="CanUserAddRows" Value="False" />
            <Setter Property="CanUserDeleteRows" Value="False" />
            <Setter Property="CanUserResizeRows" Value="False" />
            <Setter Property="GridLinesVisibility" Value="All" />
            <Setter Property="HorizontalGridLinesBrush" Value="Gainsboro" />
            <Setter Property="VerticalGridLinesBrush" Value="Gainsboro" />
            <Setter Property="Background" Value="{StaticResource SurfaceBrush}" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="RowHeight" Value="35" />
            <Setter Property="ColumnHeaderHeight" Value="45" />
            <Setter Property="FontSize" Value="16" />
            <Setter Property="FontFamily" Value="{StaticResource DefaultFontFamily}" />
            <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Auto" />
            <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto" />
            <Setter Property="CellStyle">
                <Setter.Value>
                    <Style TargetType="DataGridCell">
                        <Setter Property="BorderThickness" Value="0" />
                        <Setter Property="Padding" Value="10,0" />
                        <Setter Property="HorizontalContentAlignment" Value="Center" />
                        <Setter Property="VerticalContentAlignment" Value="Center" />
                    </Style>
                </Setter.Value>
            </Setter>
            <Setter Property="ColumnHeaderStyle">
                <Setter.Value>
                    <Style TargetType="DataGridColumnHeader">
                        <Setter Property="Background" Value="{StaticResource SurfaceBrush}" />
                        <Setter Property="Foreground" Value="Black" />
                        <Setter Property="BorderThickness" Value="0" />
                        <Setter Property="HorizontalContentAlignment" Value="Center" />
                        <Setter Property="VerticalContentAlignment" Value="Center" />
                        <Setter Property="FontFamily" Value="{StaticResource DefaultFontFamily}" />
                        <Setter Property="FontSize" Value="14" />
                        <Setter Property="Padding" Value="6,0" />
                    </Style>
                </Setter.Value>
            </Setter>
        </Style>

    </UserControl.Resources>

    <Grid ClipToBounds="False">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <Border Grid.Row="0" Style="{StaticResource TopCardStyle}" Margin="9,8,9,0">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <Button Grid.Row="0"
                        HorizontalAlignment="Left"
                        Style="{StaticResource BackButtonSmallStyle}"
                        Command="{Binding BackCommand}"
                        Width="62">
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <Viewbox Width="14" Height="14" Margin="0,0,6,0">
                            <Path Data="{StaticResource BackSvgIconGeometry}"
                                  Stretch="Uniform"
                                  Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}" />
                        </Viewbox>
                        <TextBlock Text="Back"
                                   Foreground="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}" />
                    </StackPanel>
                </Button>

                <TextBlock Grid.Row="1"
                           Margin="0,10,0,0"
                           Text="Container Profile"
                           FontFamily="{StaticResource DefaultFontFamily}"
                           FontSize="{StaticResource FontSizePageTitle}"
                           Foreground="Black" />

                <TextBlock Grid.Row="2"
                           Margin="0,6,0,0"
                           Text="Here you can see container profile details"
                           FontFamily="{StaticResource DefaultFontFamily}"
                           FontSize="17"
                           Foreground="{StaticResource SecondaryTextBrush}" />
            </Grid>
        </Border>

        <ScrollViewer Grid.Row="1"
                      Margin="9,10,9,10"
                      VerticalScrollBarVisibility="Auto"
                      HorizontalScrollBarVisibility="Disabled"
                      Padding="0,0,0,12"
                      ClipToBounds="False">

            <Grid ClipToBounds="False">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="350" />
                    <ColumnDefinition Width="20" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <!-- LEFT: Profile Information -->
                <Border Grid.Row="0"
                        Grid.Column="0"
                        Style="{StaticResource CardStyle}"
                        Margin="0,12,0,12"
                        VerticalAlignment="Top"
                        MaxHeight="520">

                    <Grid Margin="15">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <StackPanel Grid.Row="0" Orientation="Horizontal" VerticalAlignment="Center">
                            <Viewbox Width="20" Height="20" Margin="0,0,8,0">
                                <Path Data="{StaticResource IconContainerInfo}"
                                      Fill="Black"
                                      Stretch="Uniform"
                                      RenderTransformOrigin="0.5,0.5">
                                    <Path.RenderTransform>
                                        <ScaleTransform ScaleX="1" ScaleY="-1" />
                                    </Path.RenderTransform>
                                </Path>
                            </Viewbox>
                            <TextBlock Text="Profile Information"
                                       FontFamily="{StaticResource DefaultFontFamily}"
                                       FontSize="{StaticResource FontSizeTitle}"
                                       FontWeight="Bold"
                                       Foreground="Black"
                                       VerticalAlignment="Center" />
                        </StackPanel>

                        <ScrollViewer Grid.Row="1"
                                      Margin="0,14,0,0"
                                      VerticalScrollBarVisibility="Auto"
                                      HorizontalScrollBarVisibility="Disabled">
                            <StackPanel>

                                <Grid Margin="0,0,0,10">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>

                                    <TextBlock Text="Container ID:"
                                               FontFamily="{StaticResource DefaultFontFamily}"
                                               FontSize="12"
                                               Foreground="{StaticResource MutedTextBrush}"
                                               VerticalAlignment="Center" />

                                    <TextBlock Grid.Column="1"
                                               Text="{Binding ContainerId}"
                                               FontFamily="{StaticResource DefaultFontFamily}"
                                               FontSize="12"
                                               Margin="6,0,0,0"
                                               Foreground="Black"
                                               VerticalAlignment="Center" />
                                </Grid>

                                <TextBlock Text="Container Name:"
                                           FontFamily="{StaticResource DefaultFontFamily}"
                                           FontSize="12"
                                           Foreground="{StaticResource MutedTextBrush}" />
                                <TextBlock Text="{Binding Name}"
                                           Margin="0,4,0,0"
                                           FontFamily="{StaticResource DefaultFontFamily}"
                                           FontSize="16"
                                           Foreground="Black"
                                           TextWrapping="Wrap" />

                                <TextBlock Text="Note:"
                                           Margin="0,12,0,0"
                                           FontFamily="{StaticResource DefaultFontFamily}"
                                           FontSize="12"
                                           Foreground="{StaticResource MutedTextBrush}" />
                                <TextBlock Text="{Binding Note}"
                                           Margin="0,4,0,0"
                                           FontFamily="{StaticResource DefaultFontFamily}"
                                           FontSize="16"
                                           Foreground="Black"
                                           TextWrapping="Wrap" />
                            </StackPanel>
                        </ScrollViewer>

                        <Grid Grid.Row="2" Margin="0,12,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>

                            <Button Width="84"
                                    Height="33"
                                    Style="{StaticResource RoundedButtonStyle}"
                                    Background="{StaticResource CancelButtonBackgroundBrush}"
                                    Foreground="{StaticResource MutedTextBrush}"
                                    Content="Cancel"
                                    Command="{Binding CancelProfileCommand}" />

                            <Button Grid.Column="2"
                                    Width="86"
                                    Height="33"
                                    Margin="0,0,8,0"
                                    Style="{StaticResource RoundedButtonStyle}"
                                    Content="Edit"
                                    Command="{Binding EditCommand}" />

                            <Button Grid.Column="3"
                                    Width="86"
                                    Height="33"
                                    Style="{StaticResource RoundedButtonStyle}"
                                    Background="{StaticResource DangerBrush}"
                                    Content="Delete"
                                    Command="{Binding DeleteCommand}" />
                        </Grid>
                    </Grid>
                </Border>

                <!-- RIGHT: Schedules list -->
                <Border Grid.Row="0"
                        Grid.Column="2"
                        Margin="0,10,0,10"
                        Background="{StaticResource SurfaceBrush}"
                        CornerRadius="{StaticResource Cr20}"
                        ClipToBounds="False">

                    <Border.Effect>
                        <DropShadowEffect BlurRadius="18" ShadowDepth="2" Opacity="0.22" />
                    </Border.Effect>

                    <Grid Margin="15" DataContext="{Binding ScheduleListVm}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <Grid Grid.Row="0" Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>

                            <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                <Viewbox Width="20" Height="20" Margin="0,0,8,0">
                                    <Path Data="{StaticResource IconSchedule}"
                                          Fill="Black"
                                          Stretch="Uniform"
                                          RenderTransformOrigin="0.5,0.5">
                                        <Path.RenderTransform>
                                            <ScaleTransform ScaleX="1" ScaleY="-1" />
                                        </Path.RenderTransform>
                                    </Path>
                                </Viewbox>

                                <TextBlock Text="Schedules"
                                           FontFamily="{StaticResource DefaultFontFamily}"
                                           FontSize="{StaticResource FontSizeTitle}"
                                           FontWeight="Bold"
                                           Foreground="Black"
                                           VerticalAlignment="Center" />
                            </StackPanel>

                            <Border Grid.Column="1"
                                    Background="{StaticResource BadgeBackgroundBrush}"
                                    CornerRadius="{StaticResource Cr10}"
                                    Padding="10,4"
                                    VerticalAlignment="Center"
                                    Margin="0,0,10,0">
                                <TextBlock FontFamily="{StaticResource DefaultFontFamily}"
                                           FontSize="12"
                                           Foreground="{StaticResource MutedTextBrush}"
                                           Text="{Binding Items.Count, StringFormat=Total: {0}}" />
                            </Border>
                        </Grid>

                        <Grid Grid.Row="1" Height="37" Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="37" />
                                <ColumnDefinition Width="8" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="8" />
                                <ColumnDefinition Width="70" />
                                <ColumnDefinition Width="8" />
                                <ColumnDefinition Width="150" />
                                <ColumnDefinition Width="8" />
                                <ColumnDefinition Width="80" />
                            </Grid.ColumnDefinitions>

                            <Button Grid.Column="0"
                                    Style="{StaticResource IconButtonStyle}"
                                    ToolTip="Search"
                                    Command="{Binding SearchCommand}">
                                <Viewbox Width="15" Height="15">
                                    <Path Data="{StaticResource SearchIcon}"
                                          Fill="Black"
                                          Stretch="Uniform"
                                          RenderTransformOrigin="0.5,0.5">
                                        <Path.RenderTransform>
                                            <ScaleTransform ScaleX="1" ScaleY="-1" />
                                        </Path.RenderTransform>
                                    </Path>
                                </Viewbox>
                            </Button>

                            <TextBox Grid.Column="2"
                                     Style="{StaticResource CompactRoundedTextBoxWithPlaceholderStyle}"
                                     Tag="Enter search value"
                                     Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}">
                                <TextBox.InputBindings>
                                    <KeyBinding Key="Enter" Command="{Binding SearchCommand}" />
                                </TextBox.InputBindings>
                            </TextBox>

                            <Button Grid.Column="4"
                                    Style="{StaticResource RoundedButtonStyle}"
                                    Height="37"
                                    Width="70"
                                    Padding="10,0"
                                    Command="{Binding AddNewCommand}">
                                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                    <TextBlock Text="＋" FontSize="14" Margin="0,0,6,0" />
                                    <TextBlock Text="Add" FontSize="12" />
                                </StackPanel>
                            </Button>

                            <!-- ON/OFF MultiOpen -->
                            <Button Grid.Column="6"
                                    Style="{StaticResource MultiOpenPrettyButtonStyle}"
                                    Height="37"
                                    Width="150"
                                    Command="{Binding ToggleMultiOpenCommand}">
                            </Button>

                            <!-- ACTION MultiOpen -->
                            <Button Grid.Column="8"
                                    Height="37"
                                    Width="80"
                                    Style="{StaticResource RoundedButtonStyle}"
                                    Command="{Binding MultiOpenCommand}">

                                <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                    <Viewbox Width="14" Height="14" Margin="0,0,6,0">
                                        <Path Data="{StaticResource MultiOpenIconOpen}"
                                              Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"
                                              Stretch="Uniform"
                                              RenderTransformOrigin="0.5,0.5">
                                            <Path.RenderTransform>
                                                <ScaleTransform ScaleX="1" ScaleY="-1" />
                                            </Path.RenderTransform>
                                        </Path>
                                    </Viewbox>

                                    <TextBlock Text="Open"
                                               VerticalAlignment="Center"
                                               Foreground="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"/>
                                </StackPanel>
                            </Button>

                        </Grid>

                        <Border Grid.Row="2"
                                Background="{StaticResource SurfaceBrush}"
                                BorderBrush="{StaticResource CardBorderBrush}"
                                BorderThickness="2"
                                CornerRadius="{StaticResource Cr20}"
                                Padding="6"
                                ClipToBounds="True">

                            <DataGrid x:Name="dataGridSchedules"
                                      Style="{StaticResource ScheduleCardGridStyle}"
                                      Background="Transparent"
                                      BorderThickness="0"
                                      ItemsSource="{Binding Items}"
                                      SelectedItem="{Binding SelectedItem}"
                                      PreviewMouseDoubleClick="DataGridSchedules_PreviewMouseDoubleClick">

                                <DataGrid.Columns>

                                    <!-- MULTIOPEN CHECKBOX колонка -->
                                    <DataGridTemplateColumn Width="Auto" MinWidth="0">

                                        <DataGridTemplateColumn.HeaderStyle>
                                            <Style TargetType="DataGridColumnHeader">
                                                <Setter Property="Visibility" Value="Collapsed" />
                                            </Style>
                                        </DataGridTemplateColumn.HeaderStyle>

                                        <DataGridTemplateColumn.CellStyle>
                                            <Style TargetType="DataGridCell">
                                                <Setter Property="Padding" Value="0" />
                                                <Setter Property="BorderThickness" Value="0" />
                                                <Setter Property="Background" Value="Transparent" />
                                                <Setter Property="Visibility" Value="Collapsed" />

                                                <Style.Triggers>
                                                    <DataTrigger
                Binding="{Binding DataContext.IsMultiOpenEnabled,
                                  RelativeSource={RelativeSource AncestorType={x:Type DataGrid}}}"
                Value="True">
                                                        <Setter Property="Visibility" Value="Visible" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </DataGridTemplateColumn.CellStyle>


                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <CheckBox Style="{StaticResource RoundCheckBoxStyle}"
                                                          IsChecked="{Binding IsChecked, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                          VerticalAlignment="Center"
                                                          HorizontalAlignment="Center"
                                                          Margin="0,0,10,0" />
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>

                                    <!-- твої існуючі -->
                                    <DataGridTextColumn Header="Name"  Binding="{Binding Name}"       Width="*" />
                                    <DataGridTextColumn Header="Year"  Binding="{Binding Year}"       Width="*" />
                                    <DataGridTextColumn Header="Month" Binding="{Binding Month}"      Width="*" />
                                    <DataGridTextColumn Header="Shop"  Binding="{Binding Shop.Name}"  Width="*" />
                                </DataGrid.Columns>
                            </DataGrid>
                        </Border>

                        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,12,0,0"/>
                    </Grid>
                </Border>

                <!-- ===================== BOTTOM: Container Statistic ===================== -->
                <Border Grid.Row="1"
                        Grid.Column="0"
                        Grid.ColumnSpan="3"
                        Style="{StaticResource CardStyle}"
                        Padding="15"
                        Margin="0,10,0,0">

                    <StackPanel>

                        <!-- Header -->
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <Viewbox Width="18" Height="18" Margin="0,0,8,0">
                                <Path Data="{StaticResource IconInfo}" Fill="Black" Stretch="Uniform"/>
                            </Viewbox>

                            <TextBlock Text="Container Statistic"
                                       FontFamily="{StaticResource DefaultFontFamily}"
                                       FontSize="{StaticResource FontSizeTitle}"
                                       FontWeight="Bold"
                                       Foreground="Black"/>
                        </StackPanel>

                        <!-- TOP FIELDS -->
                        <WrapPanel Margin="0,12,0,0" Orientation="Horizontal" HorizontalAlignment="Left">

                            <TextBlock Margin="0,0,18,6" TextWrapping="Wrap"
                                       FontFamily="{StaticResource DefaultFontFamily}">
                                <Run Text="Container name: " FontSize="12" Foreground="{StaticResource MutedTextBrush}"/>
                                <Run Text="{Binding Name, Mode=OneWay}" FontSize="14" Foreground="Black"/>
                            </TextBlock>

                            <TextBlock Margin="0,0,18,6" TextWrapping="Wrap"
                                       FontFamily="{StaticResource DefaultFontFamily}">
                                <Run Text="Total hours: " FontSize="12" Foreground="{StaticResource MutedTextBrush}"/>
                                <Run Text="{Binding TotalHoursText, Mode=OneWay}" FontSize="14" Foreground="Black"/>
                            </TextBlock>

                            <TextBlock Margin="0,0,18,6" TextWrapping="Wrap"
                                       FontFamily="{StaticResource DefaultFontFamily}">
                                <Run Text="Total employees: " FontSize="12" Foreground="{StaticResource MutedTextBrush}"/>
                                <Run Text="{Binding TotalEmployees, Mode=OneWay}" FontSize="14" Foreground="Black"/>
                            </TextBlock>

                            <TextBlock Margin="0,0,18,6" TextWrapping="Wrap"
                                       FontFamily="{StaticResource DefaultFontFamily}">
                                <Run Text="Total shops: " FontSize="12" Foreground="{StaticResource MutedTextBrush}"/>
                                <Run Text="{Binding TotalShops, Mode=OneWay}" FontSize="14" Foreground="Black"/>
                            </TextBlock>

                        </WrapPanel>

                        <StackPanel Margin="0,6,0,0">
                            <TextBlock TextWrapping="Wrap"
                                       FontFamily="{StaticResource DefaultFontFamily}">
                                <Run Text="{Binding TotalEmployees, Mode=OneWay, StringFormat=Total employees ({0}): }"
                                     FontSize="12" Foreground="{StaticResource MutedTextBrush}"/>
                                <Run Text="{Binding TotalEmployeesListText, Mode=OneWay}" FontSize="14" Foreground="Black"/>
                            </TextBlock>

                            <TextBlock Margin="0,6,0,0" TextWrapping="Wrap"
                                       FontFamily="{StaticResource DefaultFontFamily}">
                                <Run Text="{Binding TotalShops, Mode=OneWay, StringFormat=Total shops ({0}): }"
                                     FontSize="12" Foreground="{StaticResource MutedTextBrush}"/>
                                <Run Text="{Binding TotalShopsListText, Mode=OneWay}" FontSize="14" Foreground="Black"/>
                            </TextBlock>
                        </StackPanel>

                        <!-- EmployeeShopHours DataGrid: NOT inside TextBlock -->
                        <Border Style="{StaticResource StatisticGridCardBorderStyle}"
                                Padding="12"
                                Margin="0,10,0,0"
                                SnapsToDevicePixels="True">
                            <DataGrid x:Name="dataGridContainerEmployeeShopHours"
                                      ItemsSource="{Binding EmployeeShopHoursRows}"
                                      Style="{StaticResource ContainerStatsGridStyle}"
                                      IsReadOnly="True"
                                      AutoGenerateColumns="False"
                                      FrozenColumnCount="2"
                                      Height="300"
                                      ScrollViewer.VerticalScrollBarVisibility="Auto"
                                      ScrollViewer.HorizontalScrollBarVisibility="Auto">
                                <DataGrid.Resources>
                                    <Style TargetType="{x:Type ScrollBar}"
                                           BasedOn="{StaticResource LeftRoundedScrollBarStyle}" />
                                </DataGrid.Resources>
                            </DataGrid>
                        </Border>

                        <Border Margin="0,16,0,0"
                                Style="{StaticResource StatisticGridCardBorderStyle}"
                                HorizontalAlignment="Left">

                            <DataGrid ItemsSource="{Binding EmployeeWorkFreeStats}"
                                      Style="{StaticResource ContainerStatsGridStyle}"
                                      IsReadOnly="True"
                                      AutoGenerateColumns="False"
                                      Height="320"
                                      HorizontalAlignment="Left"
                                      ColumnWidth="Auto"
                                      ScrollViewer.VerticalScrollBarVisibility="Auto"
                                      ScrollViewer.HorizontalScrollBarVisibility="Disabled">

                                <DataGrid.Resources>
                                    <Style TargetType="{x:Type ScrollBar}"
                                           BasedOn="{StaticResource LeftRoundedScrollBarStyle}" />
                                </DataGrid.Resources>

                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Employee"
                                                        Binding="{Binding Employee}"
                                                        Width="Auto"
                                                        MinWidth="220" />
                                    <DataGridTextColumn Header="WorkDays"
                                                        Binding="{Binding WorkDays}"
                                                        Width="140" />
                                    <DataGridTextColumn Header="FreeDays"
                                                        Binding="{Binding FreeDays}"
                                                        Width="140" />
                                </DataGrid.Columns>

                            </DataGrid>
                        </Border>

                    </StackPanel>
                </Border>
            </Grid>
        </ScrollViewer>
    </Grid>
</UserControl>
