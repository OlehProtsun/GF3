<Window x:Class="WPFApp.View.Dialogs.CustomMessageBoxView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        ShowInTaskbar="False"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"       
        SizeToContent="WidthAndHeight">
    

    <Window.Resources>

        <BooleanToVisibilityConverter x:Key="BoolToVis" />
        <!-- =========================================
             BUTTON BASE (Hover + Press animations)
             ========================================= -->
        <Style x:Key="AnimatedButtonBaseStyle" TargetType="Button">
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="RenderTransformOrigin" Value="0.5,0.5"/>
            <Setter Property="RenderTransform">
                <Setter.Value>
                    <ScaleTransform ScaleX="1" ScaleY="1"/>
                </Setter.Value>
            </Setter>

            <!-- Smooth animation on hover/press -->
            <Style.Triggers>

                <!-- HOVER -->
                <Trigger Property="IsMouseOver" Value="True">
                    <Trigger.EnterActions>
                        <BeginStoryboard>
                            <Storyboard>
                                <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                                                 To="1.04" Duration="0:0:0.10"/>
                                <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                                                 To="1.04" Duration="0:0:0.10"/>
                                <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                                 To="0.96" Duration="0:0:0.10"/>
                            </Storyboard>
                        </BeginStoryboard>
                    </Trigger.EnterActions>
                    <Trigger.ExitActions>
                        <BeginStoryboard>
                            <Storyboard>
                                <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                                                 To="1" Duration="0:0:0.12"/>
                                <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                                                 To="1" Duration="0:0:0.12"/>
                                <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                                 To="1" Duration="0:0:0.12"/>
                            </Storyboard>
                        </BeginStoryboard>
                    </Trigger.ExitActions>
                </Trigger>

                <!-- PRESSED (hold/click) -->
                <Trigger Property="IsPressed" Value="True">
                    <Trigger.EnterActions>
                        <BeginStoryboard>
                            <Storyboard>
                                <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                                                 To="0.96" Duration="0:0:0.06"/>
                                <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                                                 To="0.96" Duration="0:0:0.06"/>
                                <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                                 To="0.92" Duration="0:0:0.06"/>
                            </Storyboard>
                        </BeginStoryboard>
                    </Trigger.EnterActions>
                    <Trigger.ExitActions>
                        <BeginStoryboard>
                            <Storyboard>
                                <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)"
                                                 To="1.04" Duration="0:0:0.06"/>
                                <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)"
                                                 To="1.04" Duration="0:0:0.06"/>
                                <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                                 To="0.96" Duration="0:0:0.06"/>
                            </Storyboard>
                        </BeginStoryboard>
                    </Trigger.ExitActions>
                </Trigger>

                <!-- DISABLED -->
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Opacity" Value="0.5"/>
                </Trigger>

            </Style.Triggers>
        </Style>

        <!-- =========================================
             Primary rounded button
             ========================================= -->
        <Style x:Key="RoundedButtonStyle"
               TargetType="Button"
               BasedOn="{StaticResource AnimatedButtonBaseStyle}">
            <Setter Property="Height" Value="42"/>
            <Setter Property="Padding" Value="14,0"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Background" Value="#FF3347FF"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Bd"
                                Background="{TemplateBinding Background}"
                                CornerRadius="14">
                            <ContentPresenter HorizontalAlignment="Center"
                                              VerticalAlignment="Center"/>
                        </Border>

                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#FF3E57FF"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#FF2234CC"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Cancel button (grey) -->
        <Style x:Key="CancelButtonStyle"
               TargetType="Button"
               BasedOn="{StaticResource RoundedButtonStyle}">
            <Setter Property="Background" Value="#FFE0E0E0"/>
            <Setter Property="Foreground" Value="Gray"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Bd"
                                Background="{TemplateBinding Background}"
                                CornerRadius="14">
                            <ContentPresenter HorizontalAlignment="Center"
                                              VerticalAlignment="Center"/>
                        </Border>

                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#FFDADADA"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#FFCFCFCF"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- =========================================
             Close (X) button rounded + animated
             ========================================= -->
        <Style x:Key="CloseIconButtonStyle"
               TargetType="Button"
               BasedOn="{StaticResource AnimatedButtonBaseStyle}">
            <Setter Property="Width" Value="34"/>
            <Setter Property="Height" Value="34"/>
            <Setter Property="Background" Value="#e6e6e6"/>
            <Setter Property="Foreground" Value="Black"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Bd"
                                Background="{TemplateBinding Background}"
                                CornerRadius="12"
                                SnapsToDevicePixels="True">
                            <ContentPresenter HorizontalAlignment="Center"
                                              VerticalAlignment="Center"/>
                        </Border>

                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#FF3347FF"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>

                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#FF2234CC"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>

                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.5"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Card style -->
        <Style x:Key="CardStyle" TargetType="Border">
            <Setter Property="Background" Value="White"/>
            <Setter Property="CornerRadius" Value="20"/>
            <Setter Property="Padding" Value="18"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect BlurRadius="18" ShadowDepth="0" Opacity="0.12"/>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- simple icons -->
        <Geometry x:Key="IconInfo">M12,2A10,10 0 1 0 22,12A10,10 0 0 0 12,2ZM11,10H13V18H11ZM11,6H13V8H11Z</Geometry>
        <Geometry x:Key="IconWarn">M1,21H23L12,2L1,21ZM11,16H13V18H11ZM11,10H13V14H11Z</Geometry>
        <Geometry x:Key="IconError">M12,2A10,10 0 1 0 22,12A10,10 0 0 0 12,2ZM9,9L15,15M15,9L9,15</Geometry>

    </Window.Resources>

    <!-- Dim background -->
    <Grid Background="#80000000">
        
        
        
        <!-- Rounded gray shell -->
        <Border Background="#cfd0d1"
                Padding="18"
                CornerRadius="0">

            <!-- Inner card -->
            <Border Style="{StaticResource CardStyle}" Width="460">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- HEADER -->
                    <Grid Grid.Row="0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <Viewbox Width="22" Height="22" VerticalAlignment="Center" Margin="0,0,10,0">
                            <Path Stretch="Uniform" Fill="Black"
                                  Data="{Binding IconGeometry}"/>
                        </Viewbox>

                        <TextBlock Grid.Column="1"
                                   Text="{Binding Title}"
                                   FontFamily="Segoe UI"
                                   FontSize="18"
                                   FontWeight="Bold"
                                   Foreground="Black"
                                   VerticalAlignment="Center"/>

                        <!-- X -->
                        <Button Grid.Column="2"
                                Style="{StaticResource CloseIconButtonStyle}"
                                Command="{Binding CancelCommand}">
                            <TextBlock Text="✕"
                                       FontSize="14"
                                       Foreground="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center"/>
                        </Button>
                    </Grid>

                    <!-- MESSAGE -->
                    <TextBlock Grid.Row="1"
                               Margin="0,12,0,0"
                               Text="{Binding Message}"
                               FontFamily="Segoe UI"
                               FontSize="14"
                               Foreground="#333"
                               TextWrapping="Wrap"/>

                    <!-- DETAILS -->
                    <Expander Grid.Row="2"
                              Margin="0,12,0,0"
                              Header="Details"
                              Visibility="{Binding HasDetails, Converter={StaticResource BoolToVis}}">
                        <Border Background="#F5F5F5" CornerRadius="8" Padding="8" BorderBrush="#DDDDDD" BorderThickness="1">
                            <ScrollViewer MaxHeight="220" VerticalScrollBarVisibility="Auto">
                                <TextBlock Text="{Binding Details}"
                                           FontFamily="Consolas"
                                           FontSize="12"
                                           Foreground="#333"
                                           TextWrapping="Wrap"/>
                            </ScrollViewer>
                        </Border>
                    </Expander>

                    <!-- BUTTONS -->
                    <Grid Grid.Row="3" Margin="0,16,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="12"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <Button Grid.Column="1"
                                Style="{StaticResource CancelButtonStyle}"
                                Width="110"
                                Content="{Binding CancelText}"
                                Command="{Binding CancelCommand}"
                                Visibility="{Binding IsCancelVisible, Converter={StaticResource BoolToVis}}"
/>

                        <Button Grid.Column="3"
                                Style="{StaticResource RoundedButtonStyle}"
                                Width="110"
                                Content="{Binding OkText}"
                                Command="{Binding OkCommand}"/>
                    </Grid>
                </Grid>
            </Border>
        </Border>
    </Grid>
</Window>
