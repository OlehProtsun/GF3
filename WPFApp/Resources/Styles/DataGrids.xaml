<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:conv="clr-namespace:WPFApp.Converters">
    <conv:ScheduleMatrixCellBrushConverter x:Key="ScheduleMatrixCellBackgroundConverter" Kind="Background" />
    <conv:ScheduleMatrixCellBrushConverter x:Key="ScheduleMatrixCellForegroundConverter" Kind="Foreground" />
    <conv:ScheduleMatrixCellReferenceConverter x:Key="ScheduleMatrixCellReferenceConverter" />
    <Style x:Key="AvailabilityBaseGridStyle" TargetType="DataGrid">
        <Setter Property="AutoGenerateColumns" Value="True" />
        <Setter Property="IsReadOnly" Value="False" />
        <Setter Property="SelectionUnit" Value="FullRow" />
        <Setter Property="SelectionMode" Value="Single" />
        <Setter Property="CanUserAddRows" Value="False" />
        <Setter Property="CanUserDeleteRows" Value="False" />
        <Setter Property="CanUserResizeRows" Value="False" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="GridLinesVisibility" Value="None" />
        <Setter Property="Background" Value="Gainsboro" />

        <Setter Property="ColumnHeaderHeight" Value="36" />
        <Setter Property="ColumnHeaderStyle">
            <Setter.Value>
                <Style TargetType="DataGridColumnHeader">
                    <Setter Property="Background" Value="{StaticResource SurfaceBrush}" />
                    <Setter Property="Foreground" Value="Black" />
                    <Setter Property="FontFamily" Value="{StaticResource DefaultFontFamily}" />
                    <Setter Property="FontSize" Value="{StaticResource FontSizeSmall}" />
                    <Setter Property="BorderThickness" Value="0" />
                </Style>
            </Setter.Value>
        </Setter>

        <Setter Property="RowStyle">
            <Setter.Value>
                <Style TargetType="DataGridRow">
                    <Setter Property="Background" Value="{StaticResource SurfaceBrush}" />
                    <Setter Property="BorderThickness" Value="0" />
                    <Setter Property="SnapsToDevicePixels" Value="True" />
                </Style>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="AvailabilityListCardGridBaseStyle" TargetType="DataGrid">
        <Setter Property="AutoGenerateColumns" Value="False" />
        <Setter Property="FontSize" Value="14" />
        <Setter Property="FontFamily" Value="{StaticResource DefaultFontFamily}" />
        <Setter Property="IsReadOnly" Value="True" />
        <Setter Property="SelectionUnit" Value="FullRow" />
        <Setter Property="SelectionMode" Value="Single" />
        <Setter Property="HeadersVisibility" Value="Column" />
        <Setter Property="RowHeaderWidth" Value="0" />

        <Setter Property="CanUserAddRows" Value="False" />
        <Setter Property="CanUserDeleteRows" Value="False" />
        <Setter Property="CanUserResizeRows" Value="False" />

        <Setter Property="Background" Value="{StaticResource SurfaceBrush}" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="GridLinesVisibility" Value="None" />

        <Setter Property="ScrollViewer.CanContentScroll" Value="False" />
        <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Disabled" />
        <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto" />

        <Setter Property="Padding" Value="16,10,16,10" />

        <Setter Property="ColumnHeaderHeight" Value="36" />
        <Setter Property="ColumnHeaderStyle">
            <Setter.Value>
                <Style TargetType="DataGridColumnHeader">
                    <Setter Property="Background" Value="{StaticResource SurfaceBrush}" />
                    <Setter Property="Foreground" Value="Black" />
                    <Setter Property="BorderThickness" Value="0" />
                    <Setter Property="Padding" Value="10,0,10,0" />
                    <Setter Property="VerticalContentAlignment" Value="Center" />
                </Style>
            </Setter.Value>
        </Setter>

        <Setter Property="CellStyle">
            <Setter.Value>
                <Style TargetType="DataGridCell">
                    <Setter Property="BorderThickness" Value="0" />
                    <Setter Property="Background" Value="Transparent" />
                    <Setter Property="Padding" Value="28,8,12,8" />
                    <Setter Property="VerticalAlignment" Value="Center" />
                </Style>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="BindsGridStyle" TargetType="DataGrid" BasedOn="{StaticResource AvailabilityBaseGridStyle}">
        <Setter Property="AutoGenerateColumns" Value="False" />
        <Setter Property="HeadersVisibility" Value="Column" />
        <Setter Property="RowHeaderWidth" Value="0" />
        <Setter Property="CanUserReorderColumns" Value="False" />
        <Setter Property="CanUserResizeColumns" Value="True" />
        <Setter Property="CanUserSortColumns" Value="True" />

        <Setter Property="RowHeight" Value="35" />
        <Setter Property="ColumnHeaderHeight" Value="45" />
        <Setter Property="FontSize" Value="14" />

        <Setter Property="Background" Value="Transparent" />
        <Setter Property="BorderThickness" Value="0" />

        <Setter Property="GridLinesVisibility" Value="All" />
        <Setter Property="HorizontalGridLinesBrush" Value="Gainsboro" />
        <Setter Property="VerticalGridLinesBrush" Value="Gainsboro" />

        <Setter Property="ColumnHeaderStyle">
            <Setter.Value>
                <Style TargetType="DataGridColumnHeader">
                    <Setter Property="Background" Value="{StaticResource SurfaceBrush}" />
                    <Setter Property="Foreground" Value="Black" />
                    <Setter Property="BorderThickness" Value="0" />
                    <Setter Property="HorizontalContentAlignment" Value="Left" />
                    <Setter Property="VerticalContentAlignment" Value="Center" />
                    <Setter Property="FontFamily" Value="{StaticResource DefaultFontFamily}" />
                    <Setter Property="FontSize" Value="14" />
                    <Setter Property="Padding" Value="10,0" />
                </Style>
            </Setter.Value>
        </Setter>

        <Setter Property="CellStyle">
            <Setter.Value>
                <Style TargetType="DataGridCell">
                    <Setter Property="BorderThickness" Value="0" />
                    <Setter Property="Padding" Value="10,0" />
                    <Setter Property="VerticalContentAlignment" Value="Center" />
                    <Style.Triggers>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter Property="Background" Value="{StaticResource RowHoverBrush}" />
                            <Setter Property="Foreground" Value="Black" />
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </Setter.Value>
        </Setter>

        <Setter Property="AlternationCount" Value="2" />
        <Setter Property="AlternatingRowBackground" Value="{StaticResource RowAlternateBrush}" />
        <Setter Property="RowStyle">
            <Setter.Value>
                <Style TargetType="DataGridRow">
                    <Setter Property="Background" Value="{StaticResource SurfaceBrush}" />
                    <Setter Property="BorderThickness" Value="0" />
                    <Setter Property="SnapsToDevicePixels" Value="True" />
                    <Style.Triggers>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Background" Value="{StaticResource RowHoverBrush}" />
                        </Trigger>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter Property="Background" Value="{StaticResource RowHoverBrush}" />
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="ScheduleMatrixGridStyle" TargetType="DataGrid" BasedOn="{StaticResource AvailabilityBaseGridStyle}">
        <Setter Property="AutoGenerateColumns" Value="True" />
        <Setter Property="HeadersVisibility" Value="Column" />
        <Setter Property="RowHeaderWidth" Value="0" />
        <Setter Property="SelectionUnit" Value="Cell" />
        <Setter Property="SelectionMode" Value="Single" />
        <Setter Property="CanUserAddRows" Value="False" />
        <Setter Property="CanUserDeleteRows" Value="False" />
        <Setter Property="CanUserResizeRows" Value="False" />
        <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Auto" />
        <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto" />
        <Setter Property="ColumnWidth" Value="*" />
        <Setter Property="MinColumnWidth" Value="140" />
        <Setter Property="FrozenColumnCount" Value="1" />

        <Setter Property="RowHeight" Value="35" />
        <Setter Property="ColumnHeaderHeight" Value="45" />
        <Setter Property="FontSize" Value="16" />
        <Setter Property="ColumnWidth" Value="*" />

        <Setter Property="GridLinesVisibility" Value="All" />
        <Setter Property="HorizontalGridLinesBrush" Value="Gainsboro" />
        <Setter Property="VerticalGridLinesBrush" Value="Gainsboro" />
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="BorderThickness" Value="0" />

        <Setter Property="CellStyle">
            <Setter.Value>
                <Style TargetType="DataGridCell">
                    <Setter Property="BorderThickness" Value="0" />
                    <Setter Property="Padding" Value="10,0" />
                    <Setter Property="HorizontalContentAlignment" Value="Center" />
                    <Setter Property="VerticalContentAlignment" Value="Center" />
                </Style>
            </Setter.Value>
        </Setter>

        <Setter Property="ColumnHeaderStyle">
            <Setter.Value>
                <Style TargetType="DataGridColumnHeader">
                    <Setter Property="Background" Value="{StaticResource SurfaceBrush}" />
                    <Setter Property="Foreground" Value="Black" />
                    <Setter Property="BorderThickness" Value="0" />
                    <Setter Property="HorizontalContentAlignment" Value="Center" />
                    <Setter Property="VerticalContentAlignment" Value="Center" />
                    <Setter Property="FontFamily" Value="{StaticResource DefaultFontFamily}" />
                    <Setter Property="FontSize" Value="14" />
                    <Setter Property="Padding" Value="6,0" />
                </Style>
            </Setter.Value>
        </Setter>

        <Setter Property="RowStyle">
            <Setter.Value>
                <Style TargetType="DataGridRow">
                    <Setter Property="Background" Value="{StaticResource SurfaceBrush}" />
                    <Setter Property="HorizontalContentAlignment" Value="Center" />
                    <Setter Property="VerticalContentAlignment" Value="Center" />
                    <Setter Property="SnapsToDevicePixels" Value="True" />
                </Style>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="ScheduleMatrixCompactGridStyle" TargetType="DataGrid" BasedOn="{StaticResource ScheduleMatrixGridStyle}">
        <Setter Property="CellStyle">
            <Setter.Value>
                <Style TargetType="DataGridCell">
                    <Setter Property="BorderThickness" Value="0" />
                    <Setter Property="Padding" Value="0" />
                    <Setter Property="HorizontalContentAlignment" Value="Center" />
                    <Setter Property="VerticalContentAlignment" Value="Center" />
                </Style>
            </Setter.Value>
        </Setter>
    </Style>

    <Style x:Key="ScheduleMatrixCellStyleBase" TargetType="DataGridCell">
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="Padding" Value="0" />
        <Setter Property="HorizontalContentAlignment" Value="Center" />
        <Setter Property="VerticalContentAlignment" Value="Center" />
        <Setter Property="Tag" Value="{Binding DataContext, RelativeSource={RelativeSource AncestorType=DataGrid}}" />
        <Setter Property="Background">
            <Setter.Value>
                <MultiBinding Converter="{StaticResource ScheduleMatrixCellBackgroundConverter}">
                    <Binding RelativeSource="{RelativeSource AncestorType=DataGrid}" Path="DataContext" />
                    <Binding Path="." />
                    <Binding RelativeSource="{RelativeSource Self}" Path="Column.SortMemberPath" />
                    <Binding RelativeSource="{RelativeSource Self}" Path="Column.Header" />
                    <Binding RelativeSource="{RelativeSource AncestorType=DataGrid}" Path="DataContext.CellStyleRevision" />
                </MultiBinding>
            </Setter.Value>
        </Setter>

        <Setter Property="Foreground">
            <Setter.Value>
                <MultiBinding Converter="{StaticResource ScheduleMatrixCellForegroundConverter}">
                    <Binding RelativeSource="{RelativeSource AncestorType=DataGrid}" Path="DataContext" />
                    <Binding Path="." />
                    <Binding RelativeSource="{RelativeSource Self}" Path="Column.SortMemberPath" />
                    <Binding RelativeSource="{RelativeSource Self}" Path="Column.Header" />
                    <Binding RelativeSource="{RelativeSource AncestorType=DataGrid}" Path="DataContext.CellStyleRevision" />
                </MultiBinding>
            </Setter.Value>
        </Setter>

    </Style>

    <Style x:Key="ScheduleMatrixCellStyleEditable"
       TargetType="DataGridCell"
       BasedOn="{StaticResource ScheduleMatrixCellStyleBase}">

        <Setter Property="ContextMenu">
            <Setter.Value>
                <ContextMenu DataContext="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">

                    <MenuItem Header="Set Background Color..."
                          Command="{Binding SetCellBackgroundColorCommand}">
                        <MenuItem.CommandParameter>
                            <MultiBinding Converter="{StaticResource ScheduleMatrixCellReferenceConverter}">
                                <!-- provider / vm -->
                                <Binding RelativeSource="{RelativeSource AncestorType=ContextMenu}" Path="PlacementTarget.Tag" />
                                <!-- row item -->
                                <Binding RelativeSource="{RelativeSource AncestorType=ContextMenu}" Path="PlacementTarget.DataContext" />
                                <!-- column key: SortMemberPath -->
                                <Binding RelativeSource="{RelativeSource AncestorType=ContextMenu}" Path="PlacementTarget.Column.SortMemberPath" />
                                <!-- column key fallback: Header -->
                                <Binding RelativeSource="{RelativeSource AncestorType=ContextMenu}" Path="PlacementTarget.Column.Header" />
                                <!-- rerender trigger -->
                                <Binding RelativeSource="{RelativeSource AncestorType=ContextMenu}" Path="PlacementTarget.Tag.CellStyleRevision" />
                            </MultiBinding>

                        </MenuItem.CommandParameter>
                    </MenuItem>

                    <MenuItem Header="Set Text Color..."
                          Command="{Binding SetCellTextColorCommand}">
                        <MenuItem.CommandParameter>
                            <MultiBinding Converter="{StaticResource ScheduleMatrixCellReferenceConverter}">
                                <Binding RelativeSource="{RelativeSource AncestorType=ContextMenu}"
                                     Path="PlacementTarget.Tag" />
                                <Binding RelativeSource="{RelativeSource AncestorType=ContextMenu}"
                                     Path="PlacementTarget.DataContext" />
                                <Binding RelativeSource="{RelativeSource AncestorType=ContextMenu}"
                                     Path="PlacementTarget.Column.SortMemberPath" />
                                <Binding RelativeSource="{RelativeSource AncestorType=ContextMenu}"
                                     Path="PlacementTarget.Tag.CellStyleRevision" />
                            </MultiBinding>
                        </MenuItem.CommandParameter>
                    </MenuItem>

                    <Separator />

                    <MenuItem Header="Clear Selected Cell Style"
                          Command="{Binding ClearSelectedCellStyleCommand}">
                        <MenuItem.CommandParameter>
                            <MultiBinding Converter="{StaticResource ScheduleMatrixCellReferenceConverter}">
                                <Binding RelativeSource="{RelativeSource AncestorType=ContextMenu}"
                                     Path="PlacementTarget.Tag" />
                                <Binding RelativeSource="{RelativeSource AncestorType=ContextMenu}"
                                     Path="PlacementTarget.DataContext" />
                                <Binding RelativeSource="{RelativeSource AncestorType=ContextMenu}"
                                     Path="PlacementTarget.Column.SortMemberPath" />
                                <Binding RelativeSource="{RelativeSource AncestorType=ContextMenu}"
                                     Path="PlacementTarget.Tag.CellStyleRevision" />
                            </MultiBinding>
                        </MenuItem.CommandParameter>
                    </MenuItem>

                </ContextMenu>
            </Setter.Value>
        </Setter>

        <Style.Triggers>
            <Trigger Property="IsSelected" Value="True">
                <Setter Property="Background"
                        Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" />
                <Setter Property="Foreground"
                        Value="{DynamicResource {x:Static SystemColors.HighlightTextBrushKey}}" />
                <Setter Property="BorderBrush"
                        Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}" />
                <Setter Property="BorderThickness" Value="1" />
            </Trigger>
        </Style.Triggers>
    </Style>

    <Style x:Key="MatrixTextBlockStyle" TargetType="TextBlock">
        <Setter Property="HorizontalAlignment" Value="Center" />
        <Setter Property="VerticalAlignment" Value="Center" />
        <Setter Property="TextAlignment" Value="Center" />
    </Style>

    <Style x:Key="MatrixCellTextBlockStyle" TargetType="TextBlock">
        <Setter Property="TextAlignment" Value="Center" />
        <Setter Property="VerticalAlignment" Value="Center" />
        <Setter Property="HorizontalAlignment" Value="Center" />
        <Setter Property="Foreground"
                Value="{Binding RelativeSource={RelativeSource AncestorType=DataGridCell}, Path=Foreground}" />
    </Style>

    <Style x:Key="MatrixCellTextBoxStyle" TargetType="TextBox">
        <Setter Property="TextAlignment" Value="Center" />
        <Setter Property="VerticalContentAlignment" Value="Center" />
        <Setter Property="Padding" Value="0" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="Foreground"
                Value="{Binding RelativeSource={RelativeSource AncestorType=DataGridCell}, Path=Foreground}" />
    </Style>

    <Style x:Key="CenterCheckBoxStyle" TargetType="CheckBox">
        <Setter Property="HorizontalAlignment" Value="Center" />
        <Setter Property="VerticalAlignment" Value="Center" />
    </Style>

    <Style x:Key="ValidatedDataGridCellStyle" TargetType="DataGridCell">
        <Style.Triggers>
            <Trigger Property="Validation.HasError" Value="True">
                <Setter Property="BorderBrush" Value="{StaticResource ErrorBrush}" />
                <Setter Property="BorderThickness" Value="1" />
                <Setter Property="Background" Value="{StaticResource ErrorBackgroundBrush}" />
                <Setter Property="ToolTip"
                        Value="{Binding RelativeSource={RelativeSource Self},
                                        Path=(Validation.Errors)[0].ErrorContent}" />
            </Trigger>
        </Style.Triggers>
    </Style>
</ResourceDictionary>
